# Рекомендации по улучшению качества модели

Обнаружены две основные проблемы, приводящие к низкой производительности модели: критический дисбаланс классов в данных и недостаточное количество шагов обучения.

### 1. Критический дисбаланс классов

**Проблема:** Ваш датасет на 92% состоит из примеров класса "0" (14,459 шт.) и только на 8% из примеров класса "1" (1,247 шт.). Модель обучается предсказывать наиболее частый класс ("0"), игнорируя более редкий.

**Решение:** Сбалансируйте классы.

*   **Метод (Oversampling):** Искусственно увеличьте количество примеров класса "1". Откройте ваш `dataset.json` и скопируйте все записи с `"result": 1` примерно 10-11 раз. Цель — достичь примерного равенства с количеством записей класса "0".

### 2. Недостаточное обучение

**Проблема:** Параметр `max_steps = 60` заставляет модель обучаться только на 480 примерах из 15,706. Это всего 3% от всего датасета, что совершенно недостаточно.

**Решение:** Обучайте модель на всем датасете в течение нескольких эпох.

*   В файле `fine_tune_gemma.py` измените `TrainingArguments`:
    *   **Удалите** строку: `max_steps = 60`.
    *   **Добавьте** строку: `num_train_epochs = 2`.

```python
# Пример изменения в TrainingArguments
args = TrainingArguments(
    per_device_train_batch_size = 2,
    gradient_accumulation_steps = 4,
    warmup_steps = 5,
    # max_steps = 60, # <--- УДАЛИТЬ
    num_train_epochs = 2, # <--- ДОБАВИТЬ
    learning_rate = 2e-4,
    # ...
),
```

### 3. (Рекомендация) Уточнение промпта

**Проблема:** Общий промпт `Provide a response to the following text` не дает модели четкого указания на задачу классификации.

**Решение:** Используйте более конкретную инструкцию.

*   В файле `fine_tune_gemma.py` измените `prompt_template`:

```python
prompt_template = """### Instruction:
Определи, является ли следующий текст рекламой. Ответь "1", если это реклама, и "0", если нет.

### Input:
{}

### Response:
{}"""
```

**Итог:** После выполнения шага 1 (балансировка данных) и применения изменений из шагов 2 и 3, повторное обучение модели должно дать значительно лучший результат.
